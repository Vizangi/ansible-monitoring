# Ansible

## Task 5

_Для подобного рода задач заводится таска в Jira (вкратце в описании описывается план проведения работ, выставляется время проведения работ, указывается исполнитель и ответственный), прикладывается документация в формате `.docx`, где прописано построчно, что будет происходить, и что делать в случае сбоя (откат). То есть вот вам еще одна строчка в резюме - придумайте, как её красиво расписать._

### Проверка состояния ПО на серверах, а также автоматическая установка в случае его отсутствия или перезапуск

- Нужно написать роль, которая сможет на всех контейнерах:
  - Проверить наличие Node Exporter / node_exporter_install_path:
    - Установить Node Exporter (если он отсутствует)
  - Проверить состояние службы Node Exporter:
    - Если не запущен, то запустить: `sudo systemctl start node_exporter.service`
  - Проверить доступность метрик Node Exporter:
    - Скрипт должен заходить на страницу `/metrics`, видеть статус `200 OK` и что метрики **`отбрасываются / не отбрасываются`** каждым экспортером
- Для скорости выполнения разверните удобным способом 10 контейнеров:
  - Сделайте имитацию, что 5 экспортеров не запущены `sudo systemctl stop node_exporter.service` и `sudo systemctl disable node_exporter.service` / если данную процедуру сделать в контейнере невозможно, то стоит подумать, как выполнить это задание по-другому (к примеру можно взять x3 виртуалки из [первого таска](https://github.com/lamjob1993/ansible-monitoring/blob/main/ansible/task_1.md) и проделать ту же процедуру с x3 Process Expoters)
  - x4 Node Exporter оставляем в контейнерах без изменений
  - x1 Node Exporter не будет установлен вообще (это будет пустой контейнер)
  - Далее запустите Ansible скрипт и убедитесь в его успешном выполнении
- Запушьте изменения в Github
