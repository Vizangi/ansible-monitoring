# Введение в Ansible

**Ansible** — это инструмент для автоматизации управления инфраструктурой, разработанный для упрощения процессов настройки, развертывания и управления серверами, приложениями и сетевыми устройствами. Он стал популярным благодаря своей простоте, отсутствию необходимости установки агентов на целевые хосты и высокой гибкости. Ansible позволяет стандартизировать процессы, минимизировать человеческие ошибки и ускорить развертывание даже самых сложных систем.

- [Повторно читаем статью](https://github.com/lamjob1993/terraform-monitoring/blob/main/terraform/beggining/0.3.%20Infrastructure%20as%20Code%20(IaC).md) про IaC и разницу между Terraform и Ansible. 

---

### **Что такое Ansible?**
Ansible работает на основе **YAML-файлов** (playbook), которые описывают, как должна выглядеть конечная конфигурация инфраструктуры. Он использует **SSH** (или WinRM для Windows) для подключения к удалённым серверам и выполнения задач. Основные сценарии применения:
- **Настройка серверов**: Установка ПО, настройка сервисов, создание пользователей.
- **Развертывание приложений**: Автоматизация деплоя кода, управления зависимостями.
- **Мониторинг и манифесты**: Управление инфраструктурой как код (Infrastructure as Code, IaC).
- **Облачные сервисы**: Настройка инфраструктуры в AWS, Azure, Docker и других.

---

### **Основные компоненты Ansible**
1. **Inventory**  
   Список хостов и групп, определяющий, на какие серверы будут применяться задачи.  
   *Пример*:  
   ```ini
   [webservers]
   web1 ansible_host=192.168.1.10
   web2 ansible_host=192.168.1.11
   ```

2. **Playbook**  
   YAML-файл, описывающий последовательность задач (tasks) и используемые роли (roles).  
   *Пример*:  
   ```yaml
   - name: Установить Nginx
     hosts: webservers
     tasks:
       - apt:
           name: nginx
           state: present
   ```

3. **Roles**  
   Структурированные наборы задач, шаблонов и переменных для повторного использования.  
   *Структура роли*:  
   ```plaintext
   roles/
   ├── my_role
   │   ├── tasks
   │   ├── templates
   │   ├── vars
   │   └── handlers
   ```

4. **Модули (Modules)**  
   Базовые блоки для выполнения действий: установка ПО (`apt`), работа с файлами (`file`), управление сервисами (`service`).

---

### **Преимущества Ansible**
- **Простота**: YAML-синтаксис и отсутствие агентов упрощают настройку.  
- **Идемпотентность**: Playbook можно запускать многократно без негативных последствий.  
- **Модульность**: Roles позволяют повторно использовать код между проектами.  
- **Гибкость**: Поддержка облачных провайдеров, Docker и других технологий.  
- **Безопасность**: Интеграция с Ansible Vault для шифрования секретов.

---

### **Структура проекта Ansible**
```plaintext
project/
├── inventory.ini        # Список хостов
├── playbook.yml         # Основной playbook
├── roles/               # Папка с ролями
│   ├── node_exporter/
│   │   ├── tasks/
│   │   ├── templates/
│   │   └── vars/
│   └── prometheus/
├── group_vars/          # Переменные для групп
└── host_vars/           # Переменные для отдельных хостов
```

---

### **Пример использования**
```bash
# Запуск playbook для установки Nginx
ansible-playbook -i inventory.ini deploy_nginx.yml
```

---

### **Почему Ansible популярен?**
- **Нет агентов**: Для работы достаточно SSH-доступа.  
- **Сообщество**: Библиотека готовых ролей в Ansible Galaxy.  
- **Интеграция**: Поддержка CI/CD (GitLab, GitHub Actions).  
- **Документация**: Полную информацию можно найти на [ansible.com](https://docs.ansible.com/).
